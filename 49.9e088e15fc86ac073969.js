"use strict";(self.webpackChunkapp_store=self.webpackChunkapp_store||[]).push([[49],{6308:(e,t,s)=>{s.d(t,{rm:()=>o,XY:()=>r.XY,ec:()=>r.ec,lg:()=>r.lg,Wm:()=>r.Wm,ez:()=>r.ez});var r=s(4556),a=s(4848),n=s(1319);const o=({category:e,onClick:t,footer:s})=>{const r=e=>{e.preventDefault(),e.stopPropagation(),t&&t()};return(0,a.jsxs)("div",{className:"CategoryCard-module_card-tskRF",children:[(0,a.jsx)("div",{className:"CategoryCard-module_cardTop-zwy1m",children:(0,a.jsx)("a",{href:"#",onClick:r,className:"CategoryCard-module_cardImage-pBC6p",children:(0,a.jsx)("img",{src:e.photo?e.photo:n,alt:e.name})})}),(0,a.jsxs)("div",{className:"CategoryCard-module_cardBottom-iovfo",children:[(0,a.jsx)("a",{href:"#",onClick:r,className:"CategoryCard-module_cardTitle-C0cLW",children:e.name}),s&&s()]})]})}},5049:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var r=s(4848),a=s(6540),n=s(6552),o=s(2702),c=s(4716),i=s(4753),d=s(6308),l=s(294),m=s(5651),u=s(8863);const h=({footerItem:e})=>{const t=(0,i.Zp)(),s=(0,a.useCallback)(((e,t)=>(0,d.Wm)({pagination:e,sorting:{type:"ASC",field:"createdAt"}},{skip:t})),[]),h=(0,a.useCallback)((({category:t,onClick:s})=>({key:t.id,render:()=>(0,r.jsx)(d.rm,{category:t,onClick:s?()=>s(t.id):void 0,footer:e})})),[e]),f=(0,a.useCallback)((e=>h({category:e,onClick:()=>t(`${l.bw.products.basePath}${e.id}`)})),[h]),{hasMore:g,isFetching:C,items:p,handleLastItem:v}=(0,m.D)({fetchFunction:s,convertItem:f});return(0,r.jsxs)("div",{className:"CategoryList-module_container-JHTbf",children:[(0,r.jsx)(u.A,{items:p,onLastItem:v}),(!g||C)&&(0,r.jsx)(n.A,{}),!g&&(0,r.jsx)(o.A,{className:"CategoryList-module_end-M57dM",children:"Все категории загружены"}),C&&(0,r.jsx)(c.A,{})]})},f=()=>(0,r.jsx)("div",{className:"CategoryPage-module_page-FRD00",children:(0,r.jsx)(h,{})})},7231:(e,t,s)=>{s.d(t,{u:()=>o});var r=s(6540),a=s(3448),n=s(5515);const o=({form:e,error:t})=>{const{showError:s}=(0,a.J)();(0,r.useEffect)((()=>{if(t){(0,n.jS)(t),e&&e.setFields((0,n.z6)(t));const r=(0,n.bu)(t);r&&s(r)}}),[t,e,s])}},3448:(e,t,s)=>{s.d(t,{J:()=>n});var r=s(6540),a=s(582);const n=()=>{const e=(0,r.useContext)(a.N);if(!e)throw new Error("useMessage должен использоваться внутри <MessageProvider>");return e}},5651:(e,t,s)=>{s.d(t,{D:()=>n});var r=s(6540),a=s(7231);const n=({fetchFunction:e,convertItem:t})=>{const s=(0,r.useRef)([]),[n,o]=(0,r.useState)(1),[c,i]=(0,r.useState)(!0),[d,l]=(0,r.useState)([]),{data:m,isFetching:u,isLoading:h,error:f,refetch:g}=e({pageSize:10,pageNumber:n},0===n||s.current.includes(n));(0,a.u)({error:f});const C=(0,r.useCallback)((()=>{c&&!u&&o((e=>e+1))}),[c,u]);return(0,r.useEffect)((()=>{h&&u&&l([])}),[u,h]),(0,r.useEffect)((()=>{m&&m.data.length>0&&!s.current.includes(n)&&m.pagination.pageNumber===n?(s.current.push(n),l((e=>[...e,...m.data.map((e=>t(e)))]))):m&&m.data.length<10&&i(!1)}),[t,m,n]),{isFetching:u,hasMore:c,items:d,refetch:g,handleLastItem:C}}},4274:(e,t,s)=>{s.d(t,{p:()=>n});var r=s(4848),a=s(6540);const n=({isGrid:e,items:t,lastItemRef:s,onLastItemChanged:a})=>0===t.length?(0,r.jsx)("div",{className:"RenderList-module_empty-VeKxm",children:"No items to display"}):(0,r.jsx)("ul",{className:void 0===e||e?"RenderList-module_listGrid-VEEh9":"RenderList-module_list-BF_R0",children:t.map(((e,n)=>(0,r.jsx)(c,{item:e,ref:i({items:t,index:n,lastItemRef:s,onLastItemChanged:a})},e.key)))}),o=(0,a.forwardRef)((({item:e},t)=>(0,r.jsx)("li",{id:e.key,ref:t,className:"RenderList-module_listItem-d2Xxn",children:e.render()})));o.displayName="ItemRef";const c=(0,a.memo)(o),i=({items:e,index:t,lastItemRef:s,onLastItemChanged:r})=>a=>{t===e.length-1&&s&&(s.current=a,r&&r(e[e.length-1].key))}},8863:(e,t,s)=>{s.d(t,{A:()=>o});var r=s(4848),a=s(6540),n=s(4274);const o=({items:e,onLastItem:t})=>{const[s,o]=(0,a.useState)(""),c=(0,a.useRef)(""),i=(0,a.useRef)(null),d=(0,a.useRef)(!1),l=(0,a.useCallback)((e=>{const s=e[0];(null==s?void 0:s.isIntersecting)&&!d.current&&(d.current=!0,t())}),[t]);return(0,a.useEffect)((()=>{if(s===c.current)return;c.current=s;const e=new IntersectionObserver(l,{threshold:.5}),t=i.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}}),[l,s]),(0,a.useEffect)((()=>{d.current=!1}),[s]),(0,r.jsx)(n.p,{items:e,lastItemRef:i,onLastItemChanged:o})}}}]);
//# sourceMappingURL=49.9e088e15fc86ac073969.js.map