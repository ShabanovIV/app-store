"use strict";(self.webpackChunkapp_store=self.webpackChunkapp_store||[]).push([[28],{9028:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var r=s(4848),n=s(4753),a=s(6540),c=s(6552),i=s(4716),o=s(5681),u=s(294),d=s(5651),l=s(3358);const m=({categoryId:e})=>{const t=(0,n.Zp)(),s=(0,a.useCallback)(((t,s)=>(0,o.Kc)({pagination:t,categoryIds:[e],sorting:{type:"ASC",field:"createdAt"}},{skip:s})),[e]),m=(0,a.useCallback)((e=>(0,o.zY)({product:e,onClick:()=>t(`${u.bw.products.basePath}${e.id}`)})),[]),{hasMore:f,isFetching:h,items:g,handleLastItem:p}=(0,d.D)({fetchFunction:s,convertItem:m});return(0,r.jsxs)("div",{className:"ProductList-module_container-N0fil",children:[(0,r.jsx)(l.A,{items:g,onLastItem:p}),!f&&(0,r.jsx)("p",{className:"ProductList-module_end-mjnfC",children:"Все категории загружены"}),h&&(0,r.jsx)(c.A,{}),h&&(0,r.jsx)(i.A,{})]})},f=()=>{const{categoryId:e}=(0,n.g)();return(0,r.jsx)(m,{categoryId:e})}},7231:(e,t,s)=>{s.d(t,{u:()=>c});var r=s(6540),n=s(3448),a=s(5515);const c=({form:e,error:t})=>{const{showError:s}=(0,n.J)();(0,r.useEffect)((()=>{if(t){(0,a.jS)(t),e&&e.setFields((0,a.z6)(t));const r=(0,a.bu)(t);r&&s(r)}}),[t,e,s])}},3448:(e,t,s)=>{s.d(t,{J:()=>a});var r=s(6540),n=s(582);const a=()=>{const e=(0,r.useContext)(n.N);if(!e)throw new Error("useMessage должен использоваться внутри <MessageProvider>");return e}},5651:(e,t,s)=>{s.d(t,{D:()=>a});var r=s(6540),n=s(7231);const a=({fetchFunction:e,convertItem:t})=>{const s=(0,r.useRef)([]),[a,c]=(0,r.useState)(1),[i,o]=(0,r.useState)(!0),[u,d]=(0,r.useState)([]),{data:l,isFetching:m,isLoading:f,error:h,refetch:g}=e({pageSize:10,pageNumber:a},0===a||s.current.includes(a));(0,n.u)({error:h});const p=(0,r.useCallback)((()=>{i&&!m&&c((e=>e+1))}),[i,m]);return(0,r.useEffect)((()=>{f&&m&&d([])}),[m,f]),(0,r.useEffect)((()=>{l&&l.data.length>0&&!s.current.includes(a)&&l.pagination.pageNumber===a?(s.current.push(a),d((e=>[...e,...l.data.map((e=>t(e)))]))):l&&l.data.length<10&&o(!1)}),[t,l,a]),{isFetching:m,hasMore:i,items:u,refetch:g,handleLastItem:p}}},3358:(e,t,s)=>{s.d(t,{A:()=>d});var r=s(4848),n=s(6540);const a={listGrid:"RenderList-module_listGrid-VEEh9",listItem:"RenderList-module_listItem-d2Xxn"},c=({items:e,lastItemRef:t,onLastItemChanged:s})=>0===e.length?(0,r.jsx)("div",{className:a.empty,children:"No items to display"}):(0,r.jsx)("ul",{className:a.listGrid,children:e.map(((n,a)=>(0,r.jsx)(o,{item:n,ref:u({items:e,index:a,lastItemRef:t,onLastItemChanged:s})},n.key)))}),i=(0,n.forwardRef)((({item:e},t)=>(0,r.jsx)("li",{id:e.key,ref:t,className:a.listItem,children:e.render()})));i.displayName="ItemRef";const o=(0,n.memo)(i),u=({items:e,index:t,lastItemRef:s,onLastItemChanged:r})=>n=>{t===e.length-1&&s&&(s.current=n,r(e[e.length-1].key))},d=({items:e,onLastItem:t})=>{const[s,a]=(0,n.useState)(""),i=(0,n.useRef)(""),o=(0,n.useRef)(null),u=(0,n.useRef)(!1),d=(0,n.useCallback)((e=>{const s=e[0];(null==s?void 0:s.isIntersecting)&&!u.current&&(u.current=!0,t())}),[t]);return(0,n.useEffect)((()=>{if(s===i.current)return;i.current=s;const e=new IntersectionObserver(d,{threshold:.5}),t=o.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}}),[d,s]),(0,n.useEffect)((()=>{u.current=!1}),[s]),(0,r.jsx)(c,{items:e,lastItemRef:o,onLastItemChanged:a})}}}]);
//# sourceMappingURL=28.4deb0e9b4aa7952618bd.js.map