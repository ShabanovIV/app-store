"use strict";(self.webpackChunkapp_store=self.webpackChunkapp_store||[]).push([[792],{4840:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(1354),o=r.n(a),s=r(6314),n=r.n(s)()(o());n.push([e.id,"html,body{margin:0;padding:0;min-height:100dvh;overflow:hidden;font-family:sans-serif}","",{version:3,sources:["webpack://./src/shared/styles/global.scss"],names:[],mappings:"AAAA,UAEE,QAAA,CACA,SAAA,CACA,iBAAA,CACA,eAAA,CACA,sBAAA",sourcesContent:["html,\nbody {\n  margin: 0;\n  padding: 0;\n  min-height: 100dvh;\n  overflow: hidden;\n  font-family: sans-serif;\n}"],sourceRoot:""}]);const i=n},4556:(e,t,r)=>{r.d(t,{BP:()=>n,Wm:()=>i});var a=r(5816),o=r(6895),s=r(5024);const n=(0,a.xP)({reducerPath:"categoryApi",baseQuery:o.S,endpoints:e=>({getCategories:e.query({query:e=>({url:"/categories",method:"GET",params:(0,s.i)(e)})}),createCategory:e.mutation({query:e=>({url:"/categories",method:"POST",body:e})}),updateCategory:e.mutation({query:({id:e,name:t,photo:r})=>({url:`/categories/${e}`,method:"PATCH",body:{name:t,photo:r}})})})}),{useGetCategoriesQuery:i,useCreateCategoryMutation:d,useUpdateCategoryMutation:l}=n},5681:(e,t,r)=>{r.d(t,{zY:()=>j,GQ:()=>n,Kc:()=>i});var a=r(5816),o=r(6895),s=r(5024);const n=(0,a.xP)({reducerPath:"productApi",baseQuery:o.S,endpoints:e=>({getProducts:e.query({query:e=>({url:"/products",method:"GET",params:(0,s.i)(e)})}),createProduct:e.mutation({query:e=>({url:"/products",method:"POST",body:e})}),updateProduct:e.mutation({query:e=>({url:`/products/${e.id}`,method:"PATCH",body:e})}),deleteProduct:e.mutation({query:e=>({url:`/products/${e}`,method:"DELETE"})})})}),{useGetProductsQuery:i,useCreateProductMutation:d,useUpdateProductMutation:l,useDeleteProductMutation:c}=n;var u=r(4848),p=r(6540),h=r(6449),m=r(9237),A=r(6928),R=r(2851);const y="AddToCart-module_buttonCart-_HFZM",_=({initialCount:e=0,onCountChanged:t})=>{const[r,a]=(0,p.useState)(e);(0,p.useEffect)((()=>{a(e)}),[e]),(0,p.useEffect)((()=>{t&&t(r)}),[r,t]);const o=()=>a((e=>e+1));return 0===r?(0,u.jsx)("button",{className:"AddToCart-module_buttonAdd-jOFf7",onClick:o,children:"В корзину"}):(0,u.jsxs)("div",{className:"AddToCart-module_containerCart-Lt0Hc",children:[(0,u.jsx)(A.Ay,{className:y,onClick:()=>a((e=>e>0?e-1:0)),children:(0,u.jsx)(h.A,{})}),(0,u.jsx)(R.A,{controls:!1,className:"AddToCart-module_inputCart-DlnB4",readOnly:!0,min:0,max:999,type:"number",value:r,onChange:e=>a(null!=e?e:0)}),(0,u.jsx)(A.Ay,{className:y,onClick:o,children:(0,u.jsx)(m.A,{})})]})};var E=r(1319);const g=(e,t="RUB")=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(e),x="ProductCard-module_cardPrices-X1MUZ",b=({product:e,footer:t})=>{const r=e.oldPrice&&e.oldPrice>e.price?Math.round(100*(e.oldPrice-e.price)/e.oldPrice):0;return(0,u.jsxs)("div",{className:"ProductCard-module_card-G3SMN",children:[(0,u.jsxs)("div",{className:"ProductCard-module_cardTop-lKhk_",children:[(0,u.jsx)("a",{href:"#",onClick:e=>e.preventDefault(),className:"ProductCard-module_cardImage-EsTWJ",children:(0,u.jsx)("img",{src:e.photo?e.photo:E,alt:e.name})}),(0,u.jsx)("div",{className:"ProductCard-module_cardLabel-ulXEv",children:`-${r}%`})]}),(0,u.jsxs)("div",{className:"ProductCard-module_cardBottom-FBtl3",children:[(0,u.jsxs)("div",{className:x,children:[(0,u.jsx)("div",{className:`${x} ProductCard-module_cardPriceDiscount-eN2ib`,children:g(e.price)}),e.oldPrice&&(0,u.jsx)("div",{className:`${x} ProductCard-module_cardPriceCommon-ETnHp`,children:g(e.oldPrice)})]}),(0,u.jsx)("a",{href:"#",onClick:e=>e.preventDefault(),className:"ProductCard-module_cardTitle-D7VzR",children:e.name}),(0,u.jsx)("div",{className:"ProductCard-module_cardFooter-JwD6U",children:t&&t()})]})]})},j=({product:e,onClick:t})=>({key:e.id,render:()=>(0,u.jsx)(b,{product:e,onClick:t?()=>t(e.id):void 0,footer:()=>(0,u.jsx)(_,{initialCount:5})})})},2052:(e,t,r)=>{r.d(t,{li:()=>a.Ay,gu:()=>i,As:()=>p,SV:()=>c,v4:()=>d,Dx:()=>o.Dx,rU:()=>o.rU,d2:()=>l,i$:()=>o.i$});var a=r(3505),o=r(3562),s=r(5816),n=r(6895);const i=(0,s.xP)({reducerPath:"profileApi",baseQuery:n.S,endpoints:e=>({profile:e.query({query:()=>({url:"/profile",method:"GET"})}),updateProfile:e.mutation({query:e=>({url:"/profile",method:"PATCH",body:e})}),changePassword:e.mutation({query:e=>({url:"/profile/change-password",method:"POST",body:e})})})}),{useProfileQuery:d,useUpdateProfileMutation:l,useChangePasswordMutation:c}=i;var u=r(2565);const p=()=>{const e=(0,u.G)(a.Cd);return{isAuth:null!==e,token:e}}},3505:(e,t,r)=>{r.d(t,{Ay:()=>p,ri:()=>u,Cd:()=>h});var a=r(5307),o=r(4180);const s={token:`token-${o.r}`,user:`user-${o.r}`},n=e=>{var t,r;t=s.token,r=e,localStorage.setItem(t,r)};var i=r(3562);const d={token:(l=s.token,localStorage.getItem(l))};var l;const c=(0,a.Z0)({name:"auth",initialState:d,reducers:{logout(e){e.token=null,(()=>{var e;e=s.token,localStorage.removeItem(e)})()}},extraReducers:e=>{e.addMatcher(i.i$.endpoints.signin.matchFulfilled,((e,t)=>{e.token=t.payload.token,n(t.payload.token)})),e.addMatcher(i.i$.endpoints.signup.matchFulfilled,((e,t)=>{e.token=t.payload.token,n(t.payload.token)}))}}),{logout:u}=c.actions,p=c.reducer,h=e=>e.auth.token},3562:(e,t,r)=>{r.d(t,{Dx:()=>d,i$:()=>n,rU:()=>i});var a=r(5816),o=r(378),s=r(4180);const n=(0,a.xP)({reducerPath:"userApi",baseQuery:(0,o.cw)({baseUrl:s.J}),endpoints:e=>({signup:e.mutation({query:e=>({url:"/signup",method:"POST",body:Object.assign(Object.assign({},e),{commandId:s.r})})}),signin:e.mutation({query:e=>({url:"/signin",method:"POST",body:e})})})}),{useSignupMutation:i,useSigninMutation:d}=n},1426:(e,t,r)=>{var a=r(4848),o=r(6540),s=r(5338),n=r(1468),i=r(4753),d=r(5307),l=r(4556),c=r(5681),u=r(2052);const p=(0,d.U1)({reducer:{auth:u.li,[u.i$.reducerPath]:u.i$.reducer,[u.gu.reducerPath]:u.gu.reducer,[l.BP.reducerPath]:l.BP.reducer,[c.GQ.reducerPath]:c.GQ.reducer},middleware:e=>e().concat(u.i$.middleware).concat(u.gu.middleware).concat(l.BP.middleware).concat(c.GQ.middleware),devTools:!0});var h=r(5571),m=r(582);const A=({children:e})=>{const[t,r]=h.Ay.useMessage();return(0,a.jsxs)(m.N.Provider,{value:{showSuccess:t.success,showError:t.error,showInfo:t.info},children:[r,e]})};var R=r(1568),y=r(6928),_=r(2790),E=r(5515);class g extends o.Component{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:{hasError:!1,error:null}}),Object.defineProperty(this,"handleRetry",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({hasError:!1,error:null})}})}static getDerivedStateFromError(e){return(0,_.rf)(e)?{hasError:!0,error:new Error((0,E._h)(e))}:(0,_.K8)(e)?{hasError:!0,error:new Error(e.message)}:{hasError:!0,error:new Error("Unknown error.")}}componentDidCatch(e,t){console.error("AppErrorBoundary caught an error:",e,t)}render(){return this.state.hasError?(0,a.jsx)(R.Ay,{status:"500",subTitle:(0,_.K8)(this.state.error)?this.state.error.message:"Unknown error",extra:(0,a.jsx)(y.Ay,{onClick:this.handleRetry,type:"primary",children:"Try again"})}):this.props.children}}const x=({children:e})=>(0,a.jsx)("main",{className:"AppContent-module_content-X1q5X",children:e});var b=r(4336),j=r(3505),f=r(294),P=r(2565);const C="AppMenu-module_item-h591S",N=()=>{const{isAuth:e}=(0,u.As)(),t=(0,P.j)(),r=(0,i.Zp)(),o=[...(0,f.pH)(),...e?(0,f.bb)():[]].filter((e=>e.isMenuItem));return(0,a.jsxs)("ul",{className:"AppMenu-module_menu-kIy7w",children:[o.map((e=>(0,a.jsx)("li",{className:C,children:(0,a.jsx)(i.N_,{to:e.path,children:e.title})},e.path))),(0,a.jsx)("li",{className:C,onClick:()=>{e&&(t((0,j.ri)()),r(f.bw.auth.path))},children:e?(0,a.jsx)(b.A,{style:{cursor:"pointer"}}):(0,a.jsx)(i.N_,{to:f.bw.auth.path,children:f.bw.auth.title})},"signin-signout")]})},v=r.p+"images/Logoc389529f86f9af6c57ba.ico",O=()=>(0,a.jsx)("div",{className:"Logo-module_logo-NpPh8",children:(0,a.jsx)(i.N_,{to:"/",children:(0,a.jsx)("img",{src:v,alt:"App Store"})})}),I=()=>(0,a.jsxs)("header",{className:"AppHeader-module_header-zuk5F",children:[(0,a.jsx)(O,{}),(0,a.jsx)(N,{})]}),S=({children:e})=>(0,a.jsxs)("div",{className:"AppLayout-module_layout-fQ34W",children:[(0,a.jsx)(I,{}),(0,a.jsx)(x,{children:e})]}),T=({children:e})=>(0,a.jsx)(A,{children:(0,a.jsx)(g,{children:(0,a.jsx)(i.I9,{children:(0,a.jsx)(n.Kq,{store:p,children:(0,a.jsx)(S,{children:e})})})})}),w=({children:e})=>{const{isAuth:t}=(0,u.As)(),r=(0,i.zy)();return t?e:(0,a.jsx)(i.C5,{to:f.bw.auth.path,state:{from:r.pathname},replace:!0})},D=(0,o.lazy)((()=>r.e(129).then(r.bind(r,7129)))),k=(0,o.lazy)((()=>Promise.all([r.e(53),r.e(498),r.e(649)]).then(r.bind(r,6649)))),L=(0,o.lazy)((()=>Promise.all([r.e(53),r.e(498),r.e(448)]).then(r.bind(r,448)))),M=(0,o.lazy)((()=>Promise.all([r.e(53),r.e(209)]).then(r.bind(r,6209)))),U=(0,o.lazy)((()=>Promise.all([r.e(53),r.e(28)]).then(r.bind(r,9028)))),H=[{path:f.bw.home.path,element:(0,a.jsx)(D,{})},{path:f.bw.auth.path,element:(0,a.jsx)(k,{})},{path:f.bw.profile.path,element:(0,a.jsx)(L,{})},{path:f.bw.category.path,element:(0,a.jsx)(M,{})},{path:f.bw.products.path,element:(0,a.jsx)(U,{})}],q=e=>e&&(0,f.bb)().map((e=>(0,a.jsx)(i.qh,{path:e.path,element:(0,a.jsx)(w,{children:F(e.path)})},e.path))),F=e=>{const t=H.find((t=>t.path===e));return t?t.element:(0,a.jsx)(R.Ay,{status:"404",title:"404",subTitle:"Sorry, the page you visited does not exist.",extra:(0,a.jsx)(y.Ay,{onClick:()=>window.location.href=f.bw.home.path,type:"primary",children:"Back Home"})})},Q=()=>{const{isAuth:e}=(0,u.As)();return(0,a.jsxs)(i.BV,{children:[(0,f.pH)().map((e=>e.type===f.PA.private?(0,a.jsx)(i.qh,{path:e.path,element:(0,a.jsx)(w,{children:F(e.path)})},e.path):(0,a.jsx)(i.qh,{path:e.path,element:F(e.path)},e.path))),q(e)]})};var V=r(5072),$=r.n(V),B=r(7825),G=r.n(B),W=r(7659),z=r.n(W),Z=r(5056),J=r.n(Z),K=r(540),X=r.n(K),Y=r(1113),ee=r.n(Y),te=r(4840),re={};re.styleTagTransform=ee(),re.setAttributes=J(),re.insert=z().bind(null,"head"),re.domAPI=G(),re.insertStyleElement=X(),$()(te.A,re),te.A&&te.A.locals&&te.A.locals,s.createRoot(document.getElementById("root")).render((0,a.jsx)(o.StrictMode,{children:(0,a.jsx)((()=>(0,a.jsx)(T,{children:(0,a.jsx)(Q,{})})),{})}))},6895:(e,t,r)=>{r.d(t,{S:()=>s});var a=r(378),o=r(4180);const s=(0,a.cw)({baseUrl:o.J,prepareHeaders:(e,{getState:t})=>{const r=t().auth.token;return r&&e.set("Authorization",`Bearer ${r}`),e}})},2790:(e,t,r)=>{r.d(t,{K8:()=>o,Zi:()=>s,rf:()=>n});var a=r(2563);const o=e=>"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message,s=e=>"object"==typeof e&&null!==e&&!(!("data"in e)||!n(null==e?void 0:e.data)),n=e=>"object"==typeof e&&null!==e&&!(!("errors"in e)||!Array.isArray(e.errors))&&e.errors.every((e=>"object"==typeof e&&null!==e&&"string"==typeof e.name&&"string"==typeof e.message&&"string"==typeof e.stack&&"extensions"in e&&"object"==typeof e.extensions&&null!==e.extensions&&!("string"!=typeof e.extensions.code||!Object.values(a.O).includes(e.extensions.code))&&(!("fieldName"in e)||"string"==typeof e.fieldName)))},5515:(e,t,r)=>{r.d(t,{_h:()=>c,bu:()=>d,jS:()=>n,z6:()=>i});var a=r(2790),o=r(2563);const s=[o.O.ERR_VALIDATION_ERROR,o.O.ERR_NOT_VALID,o.O.ERR_AUTH,o.O.ERR_NO_FILES,o.O.ERR_NOT_ALLOWED,o.O.ERR_NOT_FOUND,o.O.ERR_INVALID_QUERY_PARAMS,o.O.ERR_INTERNAL_SERVER],n=e=>{if(!(0,a.Zi)(e))throw e;if(l(e.data,s))throw e.data},i=e=>(0,a.Zi)(e)?e.data.errors.filter((e=>Boolean(e.fieldName))).map((e=>({name:e.fieldName,errors:[e.message]}))):[],d=e=>(0,a.Zi)(e)?e.data.errors.filter((e=>!e.fieldName)).map((e=>e.message)).join("\n"):null,l=(e,t)=>e.errors.some((e=>t.includes(e.extensions.code))),c=e=>e.errors.map((e=>e.message)).join("\n")},2563:(e,t,r)=>{var a;r.d(t,{O:()=>a}),function(e){e.ERR_INCORRECT_EMAIL_OR_PASSWORD="ERR_INCORRECT_EMAIL_OR_PASSWORD",e.ERR_ACCOUNT_ALREADY_EXIST="ERR_ACCOUNT_ALREADY_EXIST",e.ERR_FIELD_REQUIRED="ERR_FIELD_REQUIRED",e.ERR_INCORRECT_PASSWORD="ERR_INCORRECT_PASSWORD",e.ERR_INVALID_PASSWORD="ERR_INVALID_PASSWORD",e.ERR_NOT_VALID="ERR_NOT_VALID",e.ERR_AUTH="ERR_AUTH",e.ERR_NO_FILES="ERR_NO_FILES",e.ERR_NOT_ALLOWED="ERR_NOT_ALLOWED",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_VALIDATION_ERROR="ERR_VALIDATION_ERROR",e.ERR_INVALID_QUERY_PARAMS="ERR_INVALID_QUERY_PARAMS",e.ERR_INTERNAL_SERVER="ERR_INTERNAL_SERVER"}(a||(a={}))},4180:(e,t,r)=>{r.d(t,{J:()=>a,r:()=>o});const a="https://19429ba06ff2.vps.myjino.ru/api",o="123e4567-e89b-12d3-a456-426614174000"},294:(e,t,r)=>{r.d(t,{PA:()=>a,bb:()=>n,bw:()=>o,pH:()=>s});const a={public:"public",private:"private",privateHidden:"privateHidden"},o={home:{path:"/",title:"Home",type:a.public,isMenuItem:!0},category:{path:"/catalog",title:"Catalog",type:a.private,isMenuItem:!0},products:{basePath:"/products/",path:"/products/:categoryId",title:"Products",type:a.private,isMenuItem:!1},auth:{path:"/auth",title:"Sign In",type:a.public,isMenuItem:!1},profile:{path:"/profile",title:"Profile",type:a.privateHidden,isMenuItem:!0}},s=()=>Object.keys(o).map((e=>o[e])).filter((e=>e.type!==a.privateHidden)),n=()=>Object.keys(o).map((e=>o[e])).filter((e=>e.type===a.privateHidden))},2565:(e,t,r)=>{r.d(t,{G:()=>s,j:()=>o});var a=r(1468);const o=a.wA.withTypes(),s=a.d4},5024:(e,t,r)=>{r.d(t,{i:()=>a});const a=e=>{const t=new URLSearchParams;return Object.entries(e).forEach((([e,r])=>{null!=r&&t.append(e,"object"==typeof r?JSON.stringify(r):String(r))})),t}},582:(e,t,r)=>{r.d(t,{N:()=>a});const a=(0,r(6540).createContext)(void 0)},1319:(e,t,r)=>{e.exports=r.p+"images/empty4ca53b4adecc1d3c90e7.png"}},e=>{e.O(0,[834],(()=>e(e.s=1426))),e.O()}]);
//# sourceMappingURL=main.5d2c261072a59dd95c6b.js.map