"use strict";(self.webpackChunkapp_store=self.webpackChunkapp_store||[]).push([[448],{448:(e,s,r)=>{r.r(s),r.d(s,{default:()=>A});var a=r(4848),n=r(6540),o=r(9646),t=r(6552),i=r(2702),c=r(6928),l=r(7668),d=r(4931),u=r(4716),m=r(2052),p=r(7231),w=r(3448);const f=({isSuccess:e,mess:s})=>{const{showSuccess:r}=(0,w.J)();(0,n.useEffect)((()=>{e&&r(s)}),[e,s,r])};const h=()=>{const[e,s]=(0,n.useState)(!1),[r]=l.A.useForm(),{data:o,update:t,isUpdateSuccess:i,isLoading:w,isUpdating:h}=(e=>{const{data:s,refetch:r,isLoading:a,isSuccess:n,error:o}=(0,m.v4)(),[t,{isLoading:i,isSuccess:c,error:l}]=(0,m.d2)();return(0,p.u)({form:e,error:o}),(0,p.u)({form:e,error:l}),f({isSuccess:c,mess:"Data saved successfully"}),{data:s,refetch:r,update:e=>{return s=void 0,r=void 0,n=function*(){yield t({name:e})},new((a=void 0)||(a=Promise))((function(e,o){function t(e){try{c(n.next(e))}catch(e){o(e)}}function i(e){try{c(n.throw(e))}catch(e){o(e)}}function c(s){var r;s.done?e(s.value):(r=s.value,r instanceof a?r:new a((function(e){e(r)}))).then(t,i)}c((n=n.apply(s,r||[])).next())}));var s,r,a,n},isLoading:a,isUpdating:i,isUpdateSuccess:c,isSuccess:n}})(r);return(0,n.useEffect)((()=>{o&&r.setFieldsValue(o)}),[o,r]),(0,n.useEffect)((()=>{i&&s(!1)}),[i]),(0,a.jsxs)(l.A,{form:r,name:"ProfileForm",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:16},onFinish:e=>{t(e.name)},autoComplete:"off",children:[(0,a.jsx)(l.A.Item,{label:"Full Name",name:"name",rules:(x="name",{name:[{required:!0,message:"Please enter your username"},{min:3,max:20,message:"Username must be between 3 and 20 characters"},{pattern:/^[a-zA-Z0-9_]+$/,message:"Username can only contain letters, numbers, and underscores"}]}[x]),children:(0,a.jsx)(d.A,{onChange:()=>{s(!0)},placeholder:"John Doe"})}),(0,a.jsx)(l.A.Item,{label:"Email",name:"email",children:(0,a.jsx)(d.A,{readOnly:!0})}),(0,a.jsx)(l.A.Item,{label:"Date of Registration",name:"signUpDate",children:(0,a.jsx)(d.A,{readOnly:!0})}),(0,a.jsx)(c.Ay,{type:"primary",htmlType:"submit",style:{width:"100%"},disabled:w||h||!e,children:w?(0,a.jsx)(u.A,{}):"Save"})]});var x};var x=r(2263);const y=({onSuccess:e})=>{const[s]=l.A.useForm(),r=(e=>{const s=(0,x.f)();return r=>({password:s(x.C.password),newPassword:s(x.C.password),confirm:[{required:!0,message:"Please confirm your password"},{validator:(s,r,a)=>{r&&r!==e.getFieldValue("newPassword")?a("Passwords do not match"):a()}}]}[r])})(s),{changePass:o,isLoading:t,isSuccess:i}=(e=>{const[s,{isLoading:r,isSuccess:a,error:n}]=(0,m.SV)();return(0,p.u)({form:e,error:n}),f({isSuccess:a,mess:"Password successfully changed"}),{changePass:(e,r)=>{return a=void 0,n=void 0,t=function*(){yield s({password:e,newPassword:r})},new((o=void 0)||(o=Promise))((function(e,s){function r(e){try{c(t.next(e))}catch(e){s(e)}}function i(e){try{c(t.throw(e))}catch(e){s(e)}}function c(s){var a;s.done?e(s.value):(a=s.value,a instanceof o?a:new o((function(e){e(a)}))).then(r,i)}c((t=t.apply(a,n||[])).next())}));var a,n,o,t},isLoading:r,isSuccess:a}})(s);return(0,n.useEffect)((()=>{i&&e&&e()}),[i,e]),(0,a.jsxs)(l.A,{form:s,name:"ProfilePwdForm",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:16},onFinish:e=>{o(e.password,e.newPassword)},autoComplete:"off",children:[(0,a.jsx)(l.A.Item,{label:"Current Password",name:"password",rules:r("password"),children:(0,a.jsx)(d.A.Password,{placeholder:"Enter current password"})}),(0,a.jsx)(l.A.Item,{label:"New Password",name:"newPassword",rules:r("newPassword"),children:(0,a.jsx)(d.A.Password,{placeholder:"Enter new password"})}),(0,a.jsx)(l.A.Item,{label:"Confirm password",name:"confirm",rules:r("confirm"),children:(0,a.jsx)(d.A.Password,{placeholder:"Confirm password"})}),(0,a.jsx)(c.Ay,{type:"primary",htmlType:"submit",style:{width:"100%"},disabled:t,children:t?(0,a.jsx)(u.A,{}):"Change"})]})},{Text:g}=o.A,P=()=>{const[e,s]=(0,n.useState)(!0);return(0,a.jsxs)("div",{className:"ProfileSwitcher-module_profileCard-iu57k",children:[(0,a.jsx)("h4",{className:"ProfileSwitcher-module_title-mlJp_",children:e?"Personal data":"Password change"}),e?(0,a.jsx)(h,{}):(0,a.jsx)(y,{}),(0,a.jsx)(t.A,{}),(0,a.jsxs)(i.A,{direction:"vertical",align:"center",style:{width:"100%"},children:[(0,a.jsx)(g,{type:"secondary",children:e?"Want to change your password?":""}),(0,a.jsx)(c.Ay,{type:"link",onClick:()=>{s((e=>!e))},children:e?"Password change":"Back to Profile"})]})]})},A=()=>(0,a.jsx)(P,{})},7231:(e,s,r)=>{r.d(s,{u:()=>t});var a=r(6540),n=r(3448),o=r(5515);const t=({form:e,error:s})=>{const{showError:r}=(0,n.J)();(0,a.useEffect)((()=>{if(s){(0,o.jS)(s),e&&e.setFields((0,o.z6)(s));const a=(0,o.bu)(s);a&&r(a)}}),[s,e,r])}},3448:(e,s,r)=>{r.d(s,{J:()=>o});var a=r(6540),n=r(582);const o=()=>{const e=(0,a.useContext)(n.N);if(!e)throw new Error("useMessage должен использоваться внутри <MessageProvider>");return e}},2263:(e,s,r)=>{r.d(s,{C:()=>a,f:()=>n});const a={email:"email",password:"password"},n=()=>e=>({email:[{required:!0,message:"Please input your email"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,message:"Please enter a valid email address"}],password:[{required:!0,message:"Please enter your password"}]}[e])}}]);
//# sourceMappingURL=448.dca18fc533dacd77670b.js.map