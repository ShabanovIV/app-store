"use strict";(self.webpackChunkapp_store=self.webpackChunkapp_store||[]).push([[925],{6308:(e,t,s)=>{s.d(t,{rm:()=>o,XY:()=>a.XY,ec:()=>a.ec,lg:()=>a.lg,Wm:()=>a.Wm,ez:()=>a.ez});var a=s(4556),n=s(4848),r=s(1319);const o=({category:e,onClick:t,footer:s})=>{const a=e=>{e.preventDefault(),e.stopPropagation(),t&&t()};return(0,n.jsxs)("div",{className:"CategoryCard-module_card-tskRF",children:[(0,n.jsx)("div",{className:"CategoryCard-module_cardTop-zwy1m",children:(0,n.jsx)("a",{href:"#",onClick:a,className:"CategoryCard-module_cardImage-pBC6p",children:(0,n.jsx)("img",{src:e.photo?e.photo:r,alt:e.name})})}),(0,n.jsxs)("div",{className:"CategoryCard-module_cardBottom-iovfo",children:[(0,n.jsx)("a",{href:"#",onClick:a,className:"CategoryCard-module_cardTitle-C0cLW",children:e.name}),s&&s()]})]})}},9925:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var a=s(4848),n=s(6540),r=s(2702),o=s(515),i=s(3903),c=s(6552),d=s(4716),l=s(6308),u=s(9220),m=s(4931);const h=e=>({name:[{required:!0,message:"Please enter a name"},{min:3,max:20,message:"Name must be between 3 and 20 characters"},{pattern:/^[a-zA-Z0-9\s]+$/,message:"Name can only contain letters, numbers, and spaces"}],photo:[{pattern:/^(https?:\/\/.*\.(?:png|jpg|jpeg|gif|webp|svg))$/i,message:"Invalid photo URL",validateTrigger:"onSubmit"}]}[e]);var g=s(7231),f=s(1458);const p="create",y="update",v=({action:e,categoryId:t,onCreated:s})=>{const[r,i]=(0,n.useState)(e===p),[c]=u.A.useForm(),{data:v,isFetching:x}=((e,t,s)=>{const{data:a,refetch:n,isFetching:r,isSuccess:o,error:i}=(0,l.Wm)({ids:[t]},{skip:e});return(0,g.u)({form:s,error:i}),{data:a,refetch:n,isFetching:r,isSuccess:o}})(e===p,t,c),{update:C,isUpdating:j,isUpdateSuccess:w}=(e=>{const[t,{isLoading:s,isSuccess:a,error:n}]=(0,l.ez)();return(0,g.u)({form:e,error:n}),(0,f.j)({isSuccess:a,mess:"Data saved successfully"}),{update:()=>{return s=void 0,a=void 0,r=function*(){const s=e.getFieldsValue();yield t(s)},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{c(r.next(e))}catch(e){t(e)}}function i(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,i)}c((r=r.apply(s,a||[])).next())}));var s,a,n,r},isUpdating:s,isUpdateSuccess:a}})(c),{create:A,isCreating:k,isCreatingSuccess:S}=(e=>{const[t,{isLoading:s,isSuccess:a,error:n}]=(0,l.XY)();return(0,g.u)({form:e,error:n}),(0,f.j)({isSuccess:a,mess:"Category created successfully"}),{create:()=>{return s=void 0,a=void 0,r=function*(){const s=e.getFieldsValue();yield t(s)},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{c(r.next(e))}catch(e){t(e)}}function i(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,i)}c((r=r.apply(s,a||[])).next())}));var s,a,n,r},isCreating:s,isCreatingSuccess:a}})(c);return(0,n.useEffect)((()=>{v&&c.setFieldsValue(v.data[0])}),[v,c]),(0,n.useEffect)((()=>{S&&s()}),[S,s]),(0,n.useEffect)((()=>{w&&i(!1)}),[w]),(0,a.jsxs)(u.A,{form:c,name:"CategoryForm",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:16},onFinish:e===y?C:A,autoComplete:"off",children:[(0,a.jsx)(u.A.Item,{label:"Id",name:"id",children:(0,a.jsx)(m.A,{readOnly:!0,hidden:e===p})}),(0,a.jsx)(u.A.Item,{label:"Name",name:"name",rules:h("name"),children:(0,a.jsx)(m.A,{onChange:()=>i(!0),placeholder:"Snowboarding"})}),(0,a.jsx)(u.A.Item,{label:"Photo source",name:"photo",rules:h("photo"),children:(0,a.jsx)(m.A,{onChange:()=>i(!0),placeholder:"URL or file path"})}),(0,a.jsx)(o.Ay,{type:"primary",htmlType:"submit",style:{width:"100%"},disabled:x||j||!r,children:j||k?(0,a.jsx)(d.A,{}):e===y?"Save":"Create"})]})};var x=s(4274);const C=()=>{var e;const[t,s]=(0,n.useState)(null),{data:u,error:m}=(0,l.lg)(),[h,{isLoading:C,isSuccess:j,error:w}]=(0,l.ec)();(0,g.u)({error:m}),(0,g.u)({error:w}),(0,f.j)({isSuccess:j,mess:"Category delete successfully"});const A=(0,n.useCallback)((e=>(0,a.jsxs)(r.A,{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,a.jsx)(o.Ay,{onClick:()=>{s({action:y,category:e})},children:"Edit"}),(0,a.jsx)(o.Ay,{danger:!0,onClick:()=>{return t=void 0,s=void 0,n=function*(){return yield h(e.id)},new((a=void 0)||(a=Promise))((function(e,r){function o(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,i)}c((n=n.apply(t,s||[])).next())}));var t,s,a,n},children:"Delete"})]})),[h]),k=(0,n.useCallback)((({category:e,onClick:t})=>({key:e.id,render:()=>(0,a.jsx)(l.rm,{category:e,onClick:t?()=>t(e.id):void 0,footer:()=>A?A(e):void 0})})),[A]),S=null!==(e=null==u?void 0:u.data.map((e=>k({category:e}))))&&void 0!==e?e:[];return(0,a.jsxs)("div",{className:"CategoryEditor-module_container-Jbx0A",children:[t&&(0,a.jsx)(i.A,{title:(0,a.jsx)("p",{children:"Edit category"}),open:Boolean(t),loading:!1,onCancel:()=>s(null),footer:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(v,{action:t.action,categoryId:t.category.id,onCreated:()=>{s(null)}})}),(0,a.jsx)("div",{children:(0,a.jsx)(o.Ay,{onClick:()=>{s({action:p,category:{id:"",name:"",commandId:"",createdAt:new Date(Date.now()),updatedAt:new Date(Date.now())}})},children:"Create new category"})}),(0,a.jsx)(c.A,{}),C&&(0,a.jsx)(d.A,{}),C&&(0,a.jsx)(c.A,{}),(0,a.jsx)(x.p,{items:S})]})},j=()=>(0,a.jsx)("div",{className:"CategoryEditPage-module_page-alh3f",children:(0,a.jsx)(C,{})})},7231:(e,t,s)=>{s.d(t,{u:()=>o});var a=s(6540),n=s(3448),r=s(5515);const o=({form:e,error:t})=>{const{showError:s}=(0,n.J)();(0,a.useEffect)((()=>{if(t){(0,r.jS)(t),e&&e.setFields((0,r.z6)(t));const a=(0,r.bu)(t);a&&s(a)}}),[t,e,s])}},3448:(e,t,s)=>{s.d(t,{J:()=>r});var a=s(6540),n=s(582);const r=()=>{const e=(0,a.useContext)(n.N);if(!e)throw new Error("useMessage должен использоваться внутри <MessageProvider>");return e}},1458:(e,t,s)=>{s.d(t,{j:()=>r});var a=s(6540),n=s(3448);const r=({isSuccess:e,mess:t})=>{const{showSuccess:s}=(0,n.J)();(0,a.useEffect)((()=>{e&&s(t)}),[e,t,s])}},4274:(e,t,s)=>{s.d(t,{p:()=>r});var a=s(4848),n=s(6540);const r=({isGrid:e,items:t,lastItemRef:s,onLastItemChanged:n})=>0===t.length?(0,a.jsx)("div",{className:"RenderList-module_empty-VeKxm",children:"No items to display"}):(0,a.jsx)("ul",{className:void 0===e||e?"RenderList-module_listGrid-VEEh9":"RenderList-module_list-BF_R0",children:t.map(((e,r)=>(0,a.jsx)(i,{item:e,ref:c({items:t,index:r,lastItemRef:s,onLastItemChanged:n})},e.key)))}),o=(0,n.forwardRef)((({item:e},t)=>(0,a.jsx)("li",{id:e.key,ref:t,className:"RenderList-module_listItem-d2Xxn",children:e.render()})));o.displayName="ItemRef";const i=(0,n.memo)(o),c=({items:e,index:t,lastItemRef:s,onLastItemChanged:a})=>n=>{t===e.length-1&&s&&(s.current=n,a&&a(e[e.length-1].key))}}}]);
//# sourceMappingURL=925.74057262a9d497f52559.js.map