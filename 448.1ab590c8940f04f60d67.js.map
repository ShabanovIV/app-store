{"version":3,"file":"448.1ab590c8940f04f60d67.js","mappings":"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","sources":["webpack://app-store/./src/shared/hooks/useSuccessHandler.ts","webpack://app-store/./src/features/ProfileForm/model/useProfile.ts","webpack://app-store/./src/features/ProfileForm/ui/ProfileForm.tsx","webpack://app-store/./src/features/ProfileForm/lib/useProfileRules.ts","webpack://app-store/./src/features/ProfilePwdForm/model/useProfilePwdForm.ts","webpack://app-store/./src/features/ProfilePwdForm/ui/ProfilePwdForm.tsx","webpack://app-store/./src/features/ProfilePwdForm/lib/useProfilePwdRules.ts","webpack://app-store/./src/widgets/ProfileSwitcher/ui/ProfileSwitcher.tsx","webpack://app-store/./src/widgets/ProfileSwitcher/ui/ProfileSwitcher.module.scss?fe6c","webpack://app-store/./src/pages/ProfilePage/ProfilePage.tsx","webpack://app-store/./src/shared/api/errors/useErrorHandler.ts","webpack://app-store/./src/shared/lib/formValidation/useRules.ts"],"sourcesContent":["import { useCallback, useEffect } from 'react';\nimport { message } from 'antd';\n\ninterface UseSuccessHandlerProps {\n  isSuccess: boolean;\n  mess: string;\n}\n\nexport const useSuccessHandler = ({ isSuccess, mess }: UseSuccessHandlerProps) => {\n  const [messageApi, contextHolder] = message.useMessage();\n\n  const success = useCallback(() => {\n    messageApi.open({\n      type: 'success',\n      content: mess,\n    });\n  }, [mess]);\n\n  useEffect(() => {\n    if (isSuccess) {\n      success();\n    }\n  }, [isSuccess, success]);\n\n  return { successElement: contextHolder };\n};\n","import { FormInstance } from 'antd';\nimport { useProfileQuery, useUpdateProfileMutation } from 'src/entities/User';\nimport { useErrorHandler } from 'src/shared/api/errors/useErrorHandler';\nimport { useSuccessHandler } from 'src/shared/hooks/useSuccessHandler';\nimport { FieldType } from '../types/fields';\n\nexport const useProfile = (form: FormInstance<FieldType>) => {\n  const { data, refetch, isLoading, isSuccess, error } = useProfileQuery();\n  const [updateProfile, { isLoading: isUpdating, isSuccess: isUpdateSuccess, error: updateError }] =\n    useUpdateProfileMutation();\n  const { errorElement } = useErrorHandler({ form, error });\n  const { errorElement: errorUpdateElement } = useErrorHandler({ form, error: updateError });\n  const { successElement } = useSuccessHandler({\n    isSuccess: isUpdateSuccess,\n    mess: 'Data saved successfully',\n  });\n\n  const update = async (name: string) => {\n    await updateProfile({ name });\n  };\n\n  return {\n    data,\n    refetch,\n    update,\n    errorElement,\n    errorUpdateElement,\n    successElement,\n    isLoading,\n    isUpdating,\n    isUpdateSuccess,\n    isSuccess,\n  };\n};\n","import { useEffect, useState } from 'react';\nimport { Button, Form, FormProps, Input, Spin } from 'antd';\nimport { useProfileRules } from '../lib/useProfileRules';\nimport { useProfile } from '../model/useProfile';\nimport { FieldType } from '../types/fields';\n\nexport const ProfileForm: React.FC = () => {\n  const getProfileRules = useProfileRules();\n  const [isChanges, setIsChanges] = useState(false);\n  const [form] = Form.useForm();\n  const {\n    data,\n    update,\n    errorElement,\n    errorUpdateElement,\n    successElement,\n    isUpdateSuccess,\n    isLoading,\n    isUpdating,\n  } = useProfile(form);\n\n  useEffect(() => {\n    if (data) {\n      form.setFieldsValue(data);\n    }\n  }, [data, form]);\n\n  useEffect(() => {\n    if (isUpdateSuccess) {\n      setIsChanges(false);\n    }\n  }, [isUpdateSuccess]);\n\n  const handleChange = () => {\n    setIsChanges(true);\n  };\n\n  const onFinish: FormProps<FieldType>['onFinish'] = (values) => {\n    update(values.name);\n  };\n\n  return (\n    <Form\n      form={form}\n      name=\"ProfileForm\"\n      labelAlign=\"left\"\n      labelCol={{ span: 8 }}\n      wrapperCol={{ span: 16 }}\n      onFinish={onFinish}\n      autoComplete=\"off\"\n    >\n      {errorElement}\n      {errorUpdateElement}\n      {successElement}\n      <Form.Item<FieldType> label=\"Full Name\" name=\"name\" rules={getProfileRules('name')}>\n        <Input onChange={handleChange} placeholder=\"John Doe\" />\n      </Form.Item>\n\n      <Form.Item<FieldType> label=\"Email\" name=\"email\">\n        <Input readOnly />\n      </Form.Item>\n\n      <Form.Item<FieldType> label=\"Date of Registration\" name=\"signUpDate\">\n        <Input readOnly />\n      </Form.Item>\n\n      <Button\n        type=\"primary\"\n        htmlType=\"submit\"\n        style={{ width: '100%' }}\n        disabled={isLoading || isUpdating || !isChanges}\n      >\n        {isLoading ? <Spin /> : 'Save'}\n      </Button>\n    </Form>\n  );\n};\n","import { Rule } from 'antd/es/form';\nimport { FieldType } from '../types/fields';\n\nexport type AllowedFields = Exclude<keyof FieldType, 'email' | 'signUpDate'>;\n\nexport const useProfileRules = () => {\n  return (field: AllowedFields): Rule[] => {\n    const rules: Record<AllowedFields, Rule[]> = {\n      name: [\n        { required: true, message: 'Please enter your username' },\n        { min: 3, max: 20, message: 'Username must be between 3 and 20 characters' },\n        {\n          pattern: /^[a-zA-Z0-9_]+$/,\n          message: 'Username can only contain letters, numbers, and underscores',\n        },\n      ],\n    };\n\n    return rules[field];\n  };\n};\n","import { FormInstance } from 'antd';\nimport { useChangePasswordMutation } from 'src/entities/User';\nimport { useErrorHandler } from 'src/shared/api/errors/useErrorHandler';\nimport { useSuccessHandler } from 'src/shared/hooks/useSuccessHandler';\nimport { FieldType } from '../types/fields';\n\nexport const useProfilePassword = (form: FormInstance<FieldType>) => {\n  const [changePassword, { isLoading, isSuccess, error }] = useChangePasswordMutation();\n  const { errorElement } = useErrorHandler({ form, error });\n  const { successElement } = useSuccessHandler({\n    isSuccess,\n    mess: 'Password successfully changed',\n  });\n\n  const changePass = async (password: string, newPassword: string) => {\n    await changePassword({ password, newPassword });\n  };\n\n  return {\n    changePass,\n    errorElement,\n    successElement: successElement,\n    isLoading,\n    isSuccess,\n  };\n};\n","import { useEffect } from 'react';\nimport { Button, Form, FormProps, Input, Spin } from 'antd';\nimport { useProfilePwdRules } from '../lib/useProfilePwdRules';\nimport { useProfilePassword } from '../model/useProfilePwdForm';\nimport { FieldType } from '../types/fields';\n\ninterface ProfilePwdFormProps {\n  onSuccess?: () => void;\n}\n\nexport const ProfilePwdForm: React.FC<ProfilePwdFormProps> = ({ onSuccess }) => {\n  const [form] = Form.useForm();\n  const getPwdRules = useProfilePwdRules(form);\n  const { changePass, errorElement, successElement, isLoading, isSuccess } =\n    useProfilePassword(form);\n\n  useEffect(() => {\n    if (isSuccess && onSuccess) {\n      onSuccess();\n    }\n  }, [isSuccess]);\n\n  const onFinish: FormProps<FieldType>['onFinish'] = (values) => {\n    changePass(values.password, values.newPassword);\n  };\n\n  return (\n    <Form\n      form={form}\n      name=\"ProfilePwdForm\"\n      labelAlign=\"left\"\n      labelCol={{ span: 8 }}\n      wrapperCol={{ span: 16 }}\n      onFinish={onFinish}\n      autoComplete=\"off\"\n    >\n      {errorElement}\n      {successElement}\n      <Form.Item<FieldType>\n        label=\"Current Password\"\n        name=\"password\"\n        rules={getPwdRules('password')}\n      >\n        <Input.Password placeholder=\"Enter current password\" />\n      </Form.Item>\n\n      <Form.Item<FieldType>\n        label=\"New Password\"\n        name=\"newPassword\"\n        rules={getPwdRules('newPassword')}\n      >\n        <Input.Password placeholder=\"Enter new password\" />\n      </Form.Item>\n\n      <Form.Item<FieldType> label=\"Confirm password\" name=\"confirm\" rules={getPwdRules('confirm')}>\n        <Input.Password placeholder=\"Confirm password\" />\n      </Form.Item>\n\n      <Button type=\"primary\" htmlType=\"submit\" style={{ width: '100%' }} disabled={isLoading}>\n        {isLoading ? <Spin /> : 'Change'}\n      </Button>\n    </Form>\n  );\n};\n","import { FormInstance } from 'antd';\nimport { Rule } from 'antd/es/form';\nimport { Fields, useRules } from 'src/shared/lib/formValidation/useRules';\nimport { FieldType } from '../types/fields';\n\nexport const useProfilePwdRules = (form: FormInstance<FieldType>) => {\n  const getRules = useRules();\n  return (field: keyof FieldType): Rule[] => {\n    const rules: Record<keyof FieldType, Rule[]> = {\n      password: getRules(Fields.password),\n      newPassword: getRules(Fields.password),\n      confirm: [\n        { required: true, message: 'Please confirm your password' },\n        {\n          validator: (_, value, callback) => {\n            if (value && value !== form.getFieldValue('newPassword')) {\n              callback('Passwords do not match');\n            } else {\n              callback();\n            }\n          },\n        },\n      ],\n    };\n\n    return rules[field];\n  };\n};\n","import { useState } from 'react';\nimport { Button, Space, Typography, Divider } from 'antd';\nimport { ProfileForm } from 'src/features/ProfileForm';\nimport { ProfilePwdForm } from 'src/features/ProfilePwdForm';\nimport styles from './ProfileSwitcher.module.scss';\n\nconst { Text } = Typography;\n\nexport const ProfileSwitcher: React.FC = () => {\n  const [isProfile, setIsProfile] = useState(true);\n\n  const handleClick = () => {\n    setIsProfile((prev) => !prev);\n  };\n\n  return (\n    <div className={styles.profileCard}>\n      <h4 className={styles.title}>{isProfile ? 'Personal data' : 'Password change'}</h4>\n\n      {isProfile ? <ProfileForm /> : <ProfilePwdForm />}\n\n      <Divider />\n\n      <Space direction=\"vertical\" align=\"center\" style={{ width: '100%' }}>\n        <Text type=\"secondary\">{isProfile ? 'Want to change your password?' : ''}</Text>\n        <Button type=\"link\" onClick={handleClick}>\n          {isProfile ? 'Password change' : 'Back to Profile'}\n        </Button>\n      </Space>\n    </div>\n  );\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"profileCard\":\"ProfileSwitcher-module_profileCard-iu57k\",\"title\":\"ProfileSwitcher-module_title-mlJp_\"};","import { ProfileSwitcher } from 'src/widgets/ProfileSwitcher/';\n\nconst ProfilePage: React.FC = () => {\n  return <ProfileSwitcher />;\n};\n\nexport default ProfilePage;\n","import { useEffect } from 'react';\nimport { FormInstance, message } from 'antd';\nimport { extractFormErrors, extractWithoutFiledErrors, throwIfGlobalError } from './errorParser';\n\nexport interface UseErrorHandlerProps<TFields> {\n  form: FormInstance<TFields>;\n  error: unknown;\n}\n\nexport const useErrorHandler = <TFields>({ form, error }: UseErrorHandlerProps<TFields>) => {\n  const [messageApi, contextHolder] = message.useMessage();\n\n  useEffect(() => {\n    if (error) {\n      throwIfGlobalError(error);\n\n      form.setFields(extractFormErrors(error));\n\n      const joinedMessage = extractWithoutFiledErrors(error);\n      if (joinedMessage) {\n        messageApi.error(joinedMessage);\n      }\n    }\n  }, [error, form, messageApi]);\n\n  return {\n    errorElement: contextHolder,\n  };\n};\n","import { Rule } from 'antd/es/form';\n\nexport const Fields = {\n  email: 'email',\n  password: 'password',\n} as const;\n\nexport type Field = (typeof Fields)[keyof typeof Fields];\n\nexport const useRules = () => {\n  return (field: Field): Rule[] => {\n    const rules: Record<Field, Rule[]> = {\n      email: [\n        { required: true, message: 'Please input your email' },\n        {\n          pattern: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/,\n          message: 'Please enter a valid email address',\n        },\n      ],\n      password: [{ required: true, message: 'Please enter your password' }],\n    };\n\n    return rules[field];\n  };\n};\n"],"names":["useSuccessHandler","isSuccess","mess","messageApi","contextHolder","message","useMessage","success","useCallback","open","type","content","useEffect","successElement","ProfileForm","isChanges","setIsChanges","useState","form","useForm","data","update","errorElement","errorUpdateElement","isUpdateSuccess","isLoading","isUpdating","refetch","error","updateProfile","updateError","useErrorHandler","u","name","useProfile","setFieldsValue","labelAlign","labelCol","span","wrapperCol","onFinish","values","autoComplete","Item","label","rules","field","required","min","max","pattern","onChange","placeholder","readOnly","htmlType","style","width","disabled","ProfilePwdForm","onSuccess","getPwdRules","getRules","useRules","password","newPassword","confirm","validator","_","value","callback","getFieldValue","useProfilePwdRules","changePass","changePassword","useProfilePassword","Password","Text","ProfileSwitcher","isProfile","setIsProfile","className","direction","align","onClick","prev","setFields","joinedMessage","Fields","email"],"sourceRoot":""}