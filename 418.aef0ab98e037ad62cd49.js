"use strict";(self.webpackChunkapp_store=self.webpackChunkapp_store||[]).push([[418],{3418:(e,t,s)=>{s.r(t),s.d(t,{default:()=>p});var r=s(4848),n=s(4753),a=s(7818),o=s(6540),c=s(6552),i=s(2702),d=s(4716),u=s(429),l=s(294),m=s(5651),f=s(8863);const h=({categoryId:e,footerItem:t})=>{const s=(0,n.Zp)(),a=(0,o.useCallback)(((t,s)=>(0,u.Kc)({pagination:t,categoryIds:[e],sorting:{type:"ASC",field:"createdAt"}},{skip:s})),[e]),h=(0,o.useCallback)((e=>(({product:e,onClick:s})=>({key:e.id,render:()=>(0,r.jsx)(u.AA,{product:e,onClick:s?()=>s(e.id):void 0,footer:()=>t?t(e.id):void 0})}))({product:e,onClick:()=>s(`${l.bw.products.basePath}${e.id}`)})),[]),{hasMore:g,isFetching:p,items:I,handleLastItem:x}=(0,m.D)({fetchFunction:a,convertItem:h});return(0,r.jsxs)("div",{className:"ProductList-module_container-N0fil",children:[(0,r.jsx)(f.A,{items:I,onLastItem:x}),(p||!g)&&(0,r.jsx)(c.A,{}),!g&&(0,r.jsx)(i.A,{className:"ProductList-module_end-mjnfC",children:"Все продукты загружены"}),p&&(0,r.jsx)(d.A,{})]})},g=({categoryId:e})=>(0,r.jsx)(h,{categoryId:e,footerItem:e=>(0,r.jsx)(a.A,{productId:e})}),p=()=>{const{categoryId:e}=(0,n.g)();return(0,r.jsx)(g,{categoryId:e})}},7231:(e,t,s)=>{s.d(t,{u:()=>o});var r=s(6540),n=s(3448),a=s(5515);const o=({form:e,error:t})=>{const{showError:s}=(0,n.J)();(0,r.useEffect)((()=>{if(t){(0,a.jS)(t),e&&e.setFields((0,a.z6)(t));const r=(0,a.bu)(t);r&&s(r)}}),[t,e,s])}},3448:(e,t,s)=>{s.d(t,{J:()=>a});var r=s(6540),n=s(582);const a=()=>{const e=(0,r.useContext)(n.N);if(!e)throw new Error("useMessage должен использоваться внутри <MessageProvider>");return e}},5651:(e,t,s)=>{s.d(t,{D:()=>a});var r=s(6540),n=s(7231);const a=({fetchFunction:e,convertItem:t})=>{const s=(0,r.useRef)([]),[a,o]=(0,r.useState)(1),[c,i]=(0,r.useState)(!0),[d,u]=(0,r.useState)([]),{data:l,isFetching:m,isLoading:f,error:h,refetch:g}=e({pageSize:10,pageNumber:a},0===a||s.current.includes(a));(0,n.u)({error:h});const p=(0,r.useCallback)((()=>{c&&!m&&o((e=>e+1))}),[c,m]);return(0,r.useEffect)((()=>{f&&m&&u([])}),[m,f]),(0,r.useEffect)((()=>{l&&l.data.length>0&&!s.current.includes(a)&&l.pagination.pageNumber===a?(s.current.push(a),u((e=>[...e,...l.data.map((e=>t(e)))]))):l&&l.data.length<10&&i(!1)}),[t,l,a]),{isFetching:m,hasMore:c,items:d,refetch:g,handleLastItem:p}}},4274:(e,t,s)=>{s.d(t,{p:()=>a});var r=s(4848),n=s(6540);const a=({isGrid:e,items:t,lastItemRef:s,onLastItemChanged:n})=>0===t.length?(0,r.jsx)("div",{className:"RenderList-module_empty-VeKxm",children:"No items to display"}):(0,r.jsx)("ul",{className:void 0===e||e?"RenderList-module_listGrid-VEEh9":"RenderList-module_list-BF_R0",children:t.map(((e,a)=>(0,r.jsx)(c,{item:e,ref:i({items:t,index:a,lastItemRef:s,onLastItemChanged:n})},e.key)))}),o=(0,n.forwardRef)((({item:e},t)=>(0,r.jsx)("li",{id:e.key,ref:t,className:"RenderList-module_listItem-d2Xxn",children:e.render()})));o.displayName="ItemRef";const c=(0,n.memo)(o),i=({items:e,index:t,lastItemRef:s,onLastItemChanged:r})=>n=>{t===e.length-1&&s&&(s.current=n,r&&r(e[e.length-1].key))}},8863:(e,t,s)=>{s.d(t,{A:()=>o});var r=s(4848),n=s(6540),a=s(4274);const o=({items:e,onLastItem:t})=>{const[s,o]=(0,n.useState)(""),c=(0,n.useRef)(""),i=(0,n.useRef)(null),d=(0,n.useRef)(!1),u=(0,n.useCallback)((e=>{const s=e[0];(null==s?void 0:s.isIntersecting)&&!d.current&&(d.current=!0,t())}),[t]);return(0,n.useEffect)((()=>{if(s===c.current)return;c.current=s;const e=new IntersectionObserver(u,{threshold:.5}),t=i.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}}),[u,s]),(0,n.useEffect)((()=>{d.current=!1}),[s]),(0,r.jsx)(a.p,{items:e,lastItemRef:i,onLastItemChanged:o})}}}]);
//# sourceMappingURL=418.aef0ab98e037ad62cd49.js.map